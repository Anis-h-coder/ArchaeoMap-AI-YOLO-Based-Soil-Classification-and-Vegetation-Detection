{% extends 'base.html' %}
{% block content %}

<!-- âœ… Nature Background -->
<div class="nature-scene">
  <div class="cloud cloud1"></div>
  <div class="cloud cloud2"></div>
  <div class="leaf leaf1"></div>
  <div class="leaf leaf2"></div>
  <div class="leaf leaf3"></div>
  <div class="grass"></div>
</div>

<!-- âœ… Main Compare Section -->
<div class="flex items-center justify-center px-6 py-10 fade">
  <div class="bg-white/70 backdrop-blur-lg rounded-2xl shadow-2xl p-10 max-w-4xl w-full text-center border border-emerald-200 relative z-10 animate-pop">
    
    <h2 class="text-4xl font-extrabold text-emerald-700 mb-8 drop-shadow-sm animate-slide-down">
      ðŸŒ± Compare Two Images
    </h2>

    <form id="compare-form" method="POST" enctype="multipart/form-data" class="space-y-6">

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- Upload Box 1 -->
        <div id="drop-zone-1" class="upload-box border-2 border-dashed border-emerald-400 rounded-xl p-4 bg-green-50/70 hover:bg-green-100 transition-all cursor-pointer shadow-sm hover:shadow-lg">

          <p id="label1" class="text-gray-700 mb-2 font-medium">ðŸŒ¿ Drop Image 1 here or click to upload</p>

          <img id="imgPreview1" class="hidden preview-img" />

          <input type="file" id="file1" name="file1" accept="image/*" class="hidden">

        </div>

        <!-- Upload Box 2 -->
        <div id="drop-zone-2" class="upload-box border-2 border-dashed border-emerald-400 rounded-xl p-4 bg-green-50/70 hover:bg-green-100 transition-all cursor-pointer shadow-sm hover:shadow-lg delay-1s">

          <p id="label2" class="text-gray-700 mb-2 font-medium">ðŸŒ¾ Drop Image 2 here or click to upload</p>

          <img id="imgPreview2" class="hidden preview-img" />

          <input type="file" id="file2" name="file2" accept="image/*" class="hidden">

        </div>

      </div>

      <!-- Select -->
      <div class="animate-slide-up">
        <label class="mr-3 text-gray-800 font-semibold">Detection Type:</label>
        <select name="kind"
                class="bg-green-50 border border-emerald-300 rounded-lg px-3 py-2 text-gray-800 focus:ring-2 focus:ring-emerald-500">
          <option value="vegetation">ðŸŒ³ Vegetation</option>
          <option value="soil">ðŸŒ» Soil</option>
        </select>
      </div>

      <!-- Button -->
      <button type="submit"
              class="mt-6 px-10 py-3 bg-gradient-to-r from-teal-400 to-green-400 hover:from-teal-500 hover:to-green-500 text-white font-bold rounded-xl shadow-lg hover:scale-105 shimmer transition-all duration-300">
        Compare ðŸŒ¿
      </button>

    </form>

  </div>
</div>

<!-- âœ… Styles -->
<style>
body {
  margin: 0;
  height: 100vh;
  overflow-x: hidden;
  overflow-y: auto;
  font-family: 'Poppins', sans-serif;
}

/* âœ… Upload box styling (fixed height, no movement) */
.upload-box {
  height: 200px;
  position: relative;
  overflow: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* âœ… Perfect preview image */
.preview-img {
  position: absolute;
  width: 90%;
  height: 90%;
  object-fit: cover;
  border-radius: 12px;
  z-index: 5;
}

/* âœ… Label text stays above background */
#label1, #label2 {
  z-index: 10;
}

/* âœ… Background Scene */
.nature-scene {
  position: fixed;
  inset: 0;
  background: linear-gradient(180deg, #c7f9cc 0%, #e9fce7 60%, #f8fff9 100%);
  overflow: hidden;
  z-index: 0;
}

/* Clouds */
.cloud {
  position: absolute;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 50%;
  filter: blur(8px);
  animation: drift 60s linear infinite;
}
.cloud1 { width: 180px; height: 90px; top: 15%; left: -250px; }
.cloud2 { width: 230px; height: 110px; top: 30%; left: -350px; animation-delay: 20s; }

/* Leaves */
.leaf {
  position: absolute;
  background: linear-gradient(135deg, #34d399 0%, #059669 100%);
  border-radius: 50% 0;
  width: 25px;
  height: 18px;
  opacity: 0.8;
  animation: fall 14s linear infinite, sway 3s ease-in-out infinite alternate;
}

.leaf1 { top: -20px; left: 10%; }
.leaf2 { top: -30px; left: 50%; animation-delay: 3s; }
.leaf3 { top: -40px; left: 80%; animation-delay: 6s; }

/* Grass */
.grass {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 120px;
  background: linear-gradient(180deg, rgba(72,187,120,.4) 0%, rgba(34,197,94,.6) 100%);
  clip-path: polygon(0 60%,10% 55%,20% 60%,30% 55%,40% 60%,50% 55%,60% 60%,70% 55%,80% 60%,90% 55%,100% 60%,100% 100%,0 100%);
}

/* Animations */
@keyframes drift { from { transform: translateX(0); } to { transform: translateX(150vw); } }
@keyframes fall { 0% { transform: translateY(0) rotate(0deg); }
                  50% { transform: translateY(60vh) rotate(180deg); }
                  100% { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
@keyframes sway { from { transform: rotate(-5deg); } to { transform: rotate(5deg); } }

.fade { animation: fadeInUp 0.5s ease-out; }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.animate-pop { animation: popIn 1s ease-out; }
@keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

/* Drag Over Highlight */
#drop-zone-1.dragover, #drop-zone-2.dragover {
  background:#dcfce7;
  border-color:#10b981;
}
</style>

<!-- âœ… Drag and Drop + Preview JS -->
<script>
function setupDropZone(zoneId, inputId, imgId, labelId) {
  const dz = document.getElementById(zoneId);
  const input = document.getElementById(inputId);
  const img = document.getElementById(imgId);
  const label = document.getElementById(labelId);

  function showPreview(file) {
    const reader = new FileReader();
    reader.onload = (e) => {
      img.src = e.target.result;
      img.classList.remove("hidden");
      label.style.opacity = 0;
    };
    reader.readAsDataURL(file);
  }

  dz.addEventListener("click", () => input.click());

  input.addEventListener("change", () => {
    if (input.files[0]) showPreview(input.files[0]);
  });

  dz.addEventListener("dragover", (e) => {
    e.preventDefault();
    dz.classList.add("dragover");
  });

  dz.addEventListener("dragleave", () => dz.classList.remove("dragover"));

  dz.addEventListener("drop", (e) => {
    e.preventDefault();
    dz.classList.remove("dragover");

    const file = e.dataTransfer.files[0];
    if (!file || !file.type.startsWith("image/")) return;

    const dt = new DataTransfer();
    dt.items.add(file);
    input.files = dt.files;

    showPreview(file);
  });
}

document.addEventListener("DOMContentLoaded", () => {
  setupDropZone("drop-zone-1", "file1", "imgPreview1", "label1");
  setupDropZone("drop-zone-2", "file2", "imgPreview2", "label2");
});
</script>

{% endblock %}
